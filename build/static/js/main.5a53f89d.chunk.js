(this["webpackJsonpweather-app"]=this["webpackJsonpweather-app"]||[]).push([[0],{21:function(e,t,a){},3:function(e,t,a){"use strict";a.r(t),a.d(t,"CITIES",function(){return n}),a.d(t,"formatCityLabel",function(){return r});const n=[{name:"London",country:"United Kingdom",latitude:51.5074,longitude:-.1278},{name:"New York",country:"United States",latitude:40.7128,longitude:-74.006},{name:"Tokyo",country:"Japan",latitude:35.6895,longitude:139.6917},{name:"Sydney",country:"Australia",latitude:-33.8688,longitude:151.2093},{name:"Madrid",country:"Spain",latitude:40.4168,longitude:-3.7038},{name:"Barcelona",country:"Spain",latitude:41.3851,longitude:2.1734},{name:"Ciudad de M\xe9xico",country:"Mexico",latitude:19.4326,longitude:-99.1332},{name:"Paris",country:"France",latitude:48.8566,longitude:2.3522},{name:"Berlin",country:"Germany",latitude:52.52,longitude:13.405},{name:"Buenos Aires",country:"Argentina",latitude:-34.6037,longitude:-58.3816}],r=e=>"".concat(e.name,", ").concat(e.country)},42:function(e,t,a){"use strict";a.r(t);var n=a(1),r=a.n(n),c=a(16),l=a.n(c),i=(a(21),a(3)),o=a(4),s=a.n(o);const d=new Map;var u=a(0);var m=e=>{let{onSelect:t}=e;const[a,r]=Object(n.useState)(""),[c,l]=Object(n.useState)([]),[o,m]=Object(n.useState)(!1),h=Object(n.useRef)(null),b=Object(n.useMemo)(()=>e=>{const t=String(e).trim().toLowerCase();return t?i.CITIES.filter(e=>e.name.toLowerCase().includes(t)||e.country.toLowerCase().includes(t)).slice(0,10):[]},[]);Object(n.useEffect)(()=>()=>{h.current&&window.clearTimeout(h.current)},[]);const p=e=>{t(e),r(""),l([]),m(!1)};return Object(u.jsxs)("form",{onSubmit:e=>{e.preventDefault(),c.length>0&&p(c[0])},autoComplete:"off",className:"d-flex position-relative",children:[Object(u.jsx)("input",{className:"form-control",type:"text",value:a,onChange:e=>{const t=e.target.value;r(t),h.current&&window.clearTimeout(h.current),h.current=window.setTimeout(()=>{(async()=>{const e=await async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"es";const n=e.trim();if(!n)return[];const r=function(e){return"geocode_".concat(e.trim().toLowerCase())}("".concat(n,"_").concat(t,"_").concat(a)),c=d.get(r);if(c)return c;try{const e=await s.a.get("https://geocoding-api.open-meteo.com/v1/search",{params:{name:n,count:t,language:a,format:"json"}}),c=e&&e.data&&e.data.results?e.data.results:[],l=(Array.isArray(c)?c:[]).filter(e=>e&&"number"===typeof e.latitude&&"number"===typeof e.longitude).map(e=>({name:String(e&&e.name||""),country:String(e&&(e.country||e.country_code)||""),latitude:e.latitude,longitude:e.longitude}));return d.set(r,l),l}catch(l){return[]}}(t,10,"es");let a=e;a&&0!==a.length||(a=b(t)),l(a),m(!!t&&a.length>0)})()},300)},placeholder:"Search city (e.g., Madrid, Spain)",onFocus:()=>a.length>0&&m(!0),onBlur:()=>setTimeout(()=>m(!1),100)}),Object(u.jsx)("button",{type:"submit",className:"btn btn-primary ms-2",children:"Add"}),o&&c.length>0&&Object(u.jsx)("ul",{className:"suggestions-list list-group",children:c.map(e=>Object(u.jsx)("li",{onClick:()=>p(e),className:"suggestion-item list-group-item list-group-item-action",children:Object(i.formatCityLabel)(e)},"".concat(e.name,"-").concat(e.country)))})]})};const h={0:{label:"Despejado",icon:"\u2600\ufe0f"},1:{label:"Mayormente despejado",icon:"\ud83c\udf24\ufe0f"},2:{label:"Parcialmente nublado",icon:"\u26c5"},3:{label:"Nublado",icon:"\u2601\ufe0f"},45:{label:"Niebla",icon:"\ud83c\udf2b\ufe0f"},48:{label:"Niebla escarchada",icon:"\ud83c\udf2b\ufe0f"},51:{label:"Llovizna ligera",icon:"\ud83c\udf26\ufe0f"},53:{label:"Llovizna",icon:"\ud83c\udf26\ufe0f"},55:{label:"Llovizna intensa",icon:"\ud83c\udf27\ufe0f"},61:{label:"Lluvia ligera",icon:"\ud83c\udf27\ufe0f"},63:{label:"Lluvia",icon:"\ud83c\udf27\ufe0f"},65:{label:"Lluvia intensa",icon:"\ud83c\udf27\ufe0f"},71:{label:"Nieve ligera",icon:"\ud83c\udf28\ufe0f"},73:{label:"Nieve",icon:"\ud83c\udf28\ufe0f"},75:{label:"Nieve intensa",icon:"\u2744\ufe0f"},80:{label:"Chubascos ligeros",icon:"\ud83c\udf26\ufe0f"},81:{label:"Chubascos",icon:"\ud83c\udf26\ufe0f"},82:{label:"Chubascos intensos",icon:"\u26c8\ufe0f"},95:{label:"Tormenta",icon:"\u26c8\ufe0f"},96:{label:"Tormenta con granizo",icon:"\u26c8\ufe0f"},99:{label:"Tormenta fuerte con granizo",icon:"\u26c8\ufe0f"}};function b(e){return"number"!==typeof e?{label:"N/D",icon:"\u2139\ufe0f"}:h[e]||{label:"C\xf3digo ".concat(e),icon:"\u2139\ufe0f"}}var p=e=>{let{data:t}=e;if(!t)return Object(u.jsx)("div",{children:"No weather data available. Please enter a city."});b();return Object(u.jsxs)("div",{className:"weather-display",children:[Object(u.jsx)("h5",{className:"card-title mb-2",children:t.city}),Object(u.jsxs)("div",{className:"d-flex align-items-center mb-2",children:[Object(u.jsx)("span",{className:"me-2","aria-hidden":!0,children:"\ud83c\udf21\ufe0f"}),Object(u.jsxs)("span",{className:"me-3",children:[t.temperature,"\xb0C"]}),Object(u.jsx)("span",{className:"me-2","aria-hidden":!0,children:"\ud83d\udca7"}),Object(u.jsxs)("span",{className:"me-3",children:[t.humidity,"%"]}),Object(u.jsx)("span",{className:"me-2","aria-hidden":!0,children:"\ud83d\udca8"}),Object(u.jsxs)("span",{children:[t.windSpeed," km/h"]})]}),Object(u.jsx)("div",{className:"mb-3",children:Object(u.jsx)("span",{className:"badge bg-primary",children:t.description})}),Array.isArray(t.forecast)&&t.forecast.length>0&&Object(u.jsxs)("div",{children:[Object(u.jsx)("h6",{className:"mb-2",children:"Pron\xf3stico 5 d\xedas"}),Object(u.jsx)("div",{className:"row g-2",children:t.forecast.slice(0,5).map(e=>{const t=b(e.weathercode);return Object(u.jsx)("div",{className:"col-6 col-md-4 col-lg-3",children:Object(u.jsxs)("div",{className:"border rounded p-2 bg-light text-dark",children:[Object(u.jsx)("div",{className:"small fw-bold",children:new Date(e.date).toLocaleDateString()}),Object(u.jsx)("div",{className:"fs-5","aria-hidden":!0,children:t.icon}),Object(u.jsx)("div",{className:"small",children:t.label}),Object(u.jsxs)("div",{className:"small",children:["M\xe1x: ",e.tmax,"\xb0C"]}),Object(u.jsxs)("div",{className:"small",children:["M\xedn: ",e.tmin,"\xb0C"]}),Object(u.jsxs)("div",{className:"small",children:["\ud83c\udf27\ufe0f ",e.precipitation," mm"]})]})},e.date)})})]})]})};var j=e=>{let{items:t}=e;return t&&0!==t.length?Object(u.jsx)("div",{className:"row g-3 mt-3 justify-content-center",children:t.map(e=>Object(u.jsx)("div",{className:"col-12 col-md-8 col-lg-6 d-flex justify-content-center",children:Object(u.jsx)("div",{className:"card shadow-sm w-100",style:{maxWidth:560},children:Object(u.jsx)("div",{className:"card-body",children:Object(u.jsx)(p,{data:e})})})},e.city))}):Object(u.jsx)("div",{className:"text-center text-light",children:"No weather data available. Add a city to begin."})};var g=()=>Object(u.jsx)("footer",{className:"text-center fixed-bottom py-2",style:{background:"transparent",color:"#fff"},children:Object(u.jsxs)("small",{children:["\xa9 ",(new Date).getFullYear()," Derechos reservados \u2014 Hecho por"," ",Object(u.jsx)("a",{href:"https://github.com/brunochc",target:"_blank",rel:"noopener noreferrer",className:"link-light text-decoration-none",children:"Bruno Henriquez"})," \xb7 ","Datos por"," ",Object(u.jsx)("a",{href:"https://open-meteo.com/",target:"_blank",rel:"noopener noreferrer",className:"link-light text-decoration-none",children:"Open\u2011Meteo"})," / ",Object(u.jsx)("a",{href:"https://openweathermap.org/",target:"_blank",rel:"noopener noreferrer",className:"link-light text-decoration-none",children:"OpenWeather"})]})});var v=e=>{let{onClear:t,compareMode:a,onToggleCompare:n,provider:r,onProviderChange:c}=e;return Object(u.jsx)("nav",{className:"navbar navbar-expand-lg navbar-dark",style:{background:"transparent"},children:Object(u.jsxs)("div",{className:"container-fluid",children:[Object(u.jsx)("a",{className:"navbar-brand",href:"#",children:"Weather App"}),Object(u.jsx)("button",{className:"navbar-toggler",type:"button","data-bs-toggle":"collapse","data-bs-target":"#navbarSupportedContent","aria-controls":"navbarSupportedContent","aria-expanded":"false","aria-label":"Toggle navigation",children:Object(u.jsx)("span",{className:"navbar-toggler-icon"})}),Object(u.jsxs)("div",{className:"collapse navbar-collapse",id:"navbarSupportedContent",children:[Object(u.jsxs)("ul",{className:"navbar-nav me-auto mb-2 mb-lg-0 align-items-center",children:[Object(u.jsxs)("li",{className:"nav-item me-3",children:[Object(u.jsx)("label",{className:"form-label me-2 mb-0",children:"Proveedor"}),Object(u.jsxs)("select",{className:"form-select form-select-sm d-inline-block w-auto",value:r,onChange:e=>{const t="openweather"===e.target.value?"openweather":"openmeteo";c(t)},children:[Object(u.jsx)("option",{value:"openmeteo",children:"Open\u2011Meteo"}),Object(u.jsx)("option",{value:"openweather",children:"OpenWeather"})]})]}),Object(u.jsx)("li",{className:"nav-item me-3",children:Object(u.jsxs)("div",{className:"form-check form-switch",children:[Object(u.jsx)("input",{className:"form-check-input",type:"checkbox",id:"compareSwitch",checked:a,onChange:e=>n(e.target.checked)}),Object(u.jsx)("label",{className:"form-check-label",htmlFor:"compareSwitch",children:"Comparar m\xfaltiples"})]})}),Object(u.jsx)("li",{className:"nav-item",children:Object(u.jsx)("button",{type:"button",className:"btn btn-outline-light btn-sm",onClick:t,children:"Limpiar resultados"})})]}),Object(u.jsx)("div",{className:"d-flex",children:Object(u.jsx)("a",{href:"https://github.com/brunochc",target:"_blank",rel:"noopener noreferrer",className:"nav-link link-light",children:"GitHub"})})]})]})})},f=a(7);const y=36e5,x=e=>"weather_".concat(e.trim().toLowerCase());function O(e,t){try{const a={value:t,timestamp:Date.now()};localStorage.setItem(e,JSON.stringify(a))}catch(a){}}function w(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:y;try{const a=localStorage.getItem(e);if(!a)return null;const n=JSON.parse(a);return n&&"number"===typeof n.timestamp?Date.now()-n.timestamp>t?null:n.value:null}catch(a){return null}}function N(e){try{const t=localStorage.getItem(e);if(!t)return null;const a=JSON.parse(t);return a&&"value"in a?a.value:null}catch(t){return null}}const S=y,C="https://api.openweathermap.org",_="040cc1a80e0d12aae06817cd43789040";let k="openweather"===String("openweather").toLowerCase()?"openweather":"openmeteo";const A=async e=>{if("openweather"===k){const a=await async function(e){const t=Object(i.formatCityLabel)(e),a=x("ow_".concat(t)),n=w(a,S);if(n)return n;const{latitude:r,longitude:c}=e,l="".concat(C,"/data/2.5/weather"),o={lat:r,lon:c,appid:_,units:"metric",lang:"es"};try{var d,u,m,h,b,p;const e=await s.a.get(l,{params:o});if(200!==e.status)throw new Error("Failed to fetch OpenWeather current");const n=e.data||{},r=Number(null!==(d=null===n||void 0===n||null===(u=n.main)||void 0===u?void 0:u.temp)&&void 0!==d?d:0),c=Number(null!==(m=null===n||void 0===n||null===(h=n.main)||void 0===h?void 0:h.humidity)&&void 0!==m?m:0),i={temperature:r,humidity:c,windSpeed:"number"===typeof(null===n||void 0===n||null===(b=n.wind)||void 0===b?void 0:b.speed)?Math.round(3.6*n.wind.speed):0,description:Array.isArray(null===n||void 0===n?void 0:n.weather)&&null!==(p=n.weather[0])&&void 0!==p&&p.description?String(n.weather[0].description):"N/D",city:t,forecast:void 0};return O(a,i),i}catch(j){const e=N(a);if(e)return e;throw j}}(e);try{const t=await async function(e){var t;const{latitude:a,longitude:n}=e,r="".concat(C,"/data/3.0/onecall"),c={lat:a,lon:n,appid:_,units:"metric",lang:"es",exclude:"minutely,hourly,alerts"},l=await s.a.get(r,{params:c}),i=null===l||void 0===l||null===(t=l.data)||void 0===t?void 0:t.daily;if(Array.isArray(i))return i.slice(0,5).map(e=>{var t,a,n,r,c,l,i,o,s;return{date:new Date(1e3*Number(null!==(t=null===e||void 0===e?void 0:e.dt)&&void 0!==t?t:0)).toISOString(),tmax:Number(null!==(a=null===e||void 0===e||null===(n=e.temp)||void 0===n?void 0:n.max)&&void 0!==a?a:0),tmin:Number(null!==(r=null===e||void 0===e||null===(c=e.temp)||void 0===c?void 0:c.min)&&void 0!==r?r:0),precipitation:Number(null!==(l=null===e||void 0===e?void 0:e.rain)&&void 0!==l?l:0),weathercode:Number(null!==(i=null===e||void 0===e||null===(o=e.weather)||void 0===o||null===(s=o[0])||void 0===s?void 0:s.id)&&void 0!==i?i:0)}})}(e);return Object(f.a)(Object(f.a)({},a),{},{forecast:t})}catch(t){return a}}return(async e=>{const t=Object(i.formatCityLabel)(e),a=x(t),n=w(a,S);if(n)return n;const{latitude:r,longitude:c}=e;try{const e=await s.a.get("https://api.open-meteo.com/v1/forecast",{params:{latitude:r,longitude:c,current_weather:!0,hourly:"relativehumidity_2m",daily:"temperature_2m_max,temperature_2m_min,precipitation_sum,weathercode",forecast_days:5,timezone:"auto"}});if(200!==e.status)throw new Error("Failed to fetch weather data");const n=e.data.current_weather;if(!n)throw new Error("No current weather data available");let l;const i=e.data.daily;if(i&&Array.isArray(i.time)){const e=Math.min(i.time.length||0,(i.temperature_2m_max||[]).length,(i.temperature_2m_min||[]).length,(i.precipitation_sum||[]).length,(i.weathercode||[]).length);l=Array.from({length:e}).map((e,t)=>({date:String(i.time[t]),tmax:Number(i.temperature_2m_max[t]),tmin:Number(i.temperature_2m_min[t]),precipitation:Number(i.precipitation_sum[t]||0),weathercode:Number(i.weathercode[t])}))}const o=b(n.weathercode),d=e.data.hourly&&e.data.hourly.relativehumidity_2m,u=Array.isArray(d)&&d.length>0?Number(d[0]):0,m={temperature:n.temperature,humidity:u,windSpeed:n.windspeed,description:o.label,city:t,forecast:l};return O(a,m),m}catch(l){const e=N(a);if(e)return e;throw l}})(e)};var L=()=>{const[e,t]=Object(n.useState)([]),[a,r]=Object(n.useState)([]),[c,l]=Object(n.useState)(null),[i,o]=Object(n.useState)(!1),[s,d]=Object(n.useState)(!1);const[h,b]=Object(n.useState)("openweather"===String("openweather").toLowerCase()?"openweather":"openmeteo"),p=async e=>{o(!0),l(null);try{const t=await(async e=>{const t=Array.from(new Map(e.map(e=>["".concat(e.latitude,",").concat(e.longitude),e])).values()),a=await Promise.allSettled(t.map(e=>A(e))),n=[];return a.forEach(e=>{"fulfilled"===e.status&&n.push(e.value)}),n})(e);r(t)}catch(t){l("Error fetching weather data. Some results may be unavailable offline.")}finally{o(!1)}};Object(n.useEffect)(()=>{},[]),Object(n.useEffect)(()=>{!function(e){k=e}(h),e.length>0&&p(e)},[h]);return Object(u.jsxs)("div",{className:"container-fluid app-container",children:[Object(u.jsx)(v,{onClear:()=>{t([]),r([]),l(null)},compareMode:s,onToggleCompare:d,provider:h,onProviderChange:b}),Object(u.jsx)("h1",{className:"mb-4 text-center",children:"Weather App"}),Object(u.jsx)(m,{onSelect:async a=>{const n=e=>"".concat(e.latitude,",").concat(e.longitude);let r;if(s){r=e.some(e=>n(e)===n(a))?e:[...e,a]}else r=[a];t(r),await p(r)}}),i&&Object(u.jsx)("p",{children:"Loading..."}),c&&Object(u.jsx)("p",{children:c}),a.length>0&&Object(u.jsx)(j,{items:a}),Object(u.jsx)(g,{})]})};l.a.render(Object(u.jsx)(r.a.StrictMode,{children:Object(u.jsx)(L,{})}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.5a53f89d.chunk.js.map